function PredictiveSearchExtender(clientID,textBoxID,resultsHolderID,minChars,selectionEnabled,selectedCssClass,resultsCssClass){var me=this;this.clientID=clientID;this.resultsID="results_"+clientID;this.textBoxID=textBoxID;this.resultsHolderID=resultsHolderID;this.minChars=minChars;this.selectedCssClass=selectedCssClass;this.resultsCssClass=resultsCssClass;this.selectionEnabled=selectionEnabled;this.timeout=undefined;this.hideTimeout=undefined;this.doNotHide=!1;this.selectedResult=-1;this.lastSearchQuery="";this.RecieveSearchResults=function(arg,context){me.selectedResult=-1;me.lastSearchQuery=context;$("#"+me.resultsID).html(arg);me.selectionEnabled&&($("#"+me.resultsID+" > :not(.nonSelectable)").hover(function(){$("#"+me.resultsID+" > *").removeClass(me.selectedCssClass);$(this).addClass(me.selectedCssClass);me.selectedResult=$("#"+me.resultsID+" > :not(.nonSelectable)").index($(this))},function(){}),$("#"+me.resultsID+" > .nonSelectable").hover(function(){$("#"+me.resultsID+" > *").removeClass(me.selectedCssClass)},function(){}));arg!=""?$("#"+me.resultsID).show():$("#"+me.resultsID).hide()};this.HideResults=function(){$("#"+me.resultsID).hide()};this.MoveSelectedDown=function(){var searchResultsDiv=$("#"+me.resultsID),searchResults=$("#"+me.resultsID+" > :not(.nonSelectable)");searchResultsDiv.is(":visible")?me.selectedResult+1<=searchResults.length-1?(me.selectedResult++,searchResults.removeClass(me.selectedCssClass),searchResults.eq(me.selectedResult).addClass(me.selectedCssClass)):(me.selectedResult=-1,searchResults.removeClass(me.selectedCssClass)):searchResultsDiv.html()!=""&&(me.selectedResult=0,searchResults.removeClass(me.selectedCssClass),searchResults.eq(me.selectedResult).addClass(me.selectedCssClass),searchResultsDiv.show())};this.MoveSelectedUp=function(){var searchResults=$("#"+me.resultsID+" > :not(.nonSelectable)");me.selectedResult>0?(me.selectedResult--,searchResults.removeClass(me.selectedCssClass),searchResults.eq(me.selectedResult).addClass(me.selectedCssClass)):me.selectedResult==0?(me.selectedResult=-1,searchResults.removeClass(me.selectedCssClass)):me.selectedResult==-1&&(me.selectedResult=searchResults.length-1,searchResults.removeClass(me.selectedCssClass),searchResults.eq(me.selectedResult).addClass(me.selectedCssClass))};this.KeyChanged=function(){var query=$("#"+me.textBoxID).val();me.timeout&&clearTimeout(me.timeout);query.length>=me.minChars?query!==me.lastSearchQuery&&(me.timeout=setTimeout(function(){me.CallPredictiveSearch(query,query)},500)):me.timeout=setTimeout(function(){$("#"+me.resultsID).html("").hide();me.lastSearchQuery=""},500)};this.RedirectToResult=function(e){var selectedResultElem=$("#"+me.resultsID+" ."+me.selectedCssClass),href;selectedResultElem.length==1&&(href="",href=selectedResultElem.attr("href"),(href==undefined||href=="")&&(href=selectedResultElem.find("[href]").attr("href")),href!=undefined&&href!=""&&(e.preventDefault(),document.location.href=href))};$(function(){$("#"+me.resultsHolderID).html("<div id='"+me.resultsID+"' class='"+me.resultsCssClass+"'><\/div>");me.HideResults();$("#"+me.textBoxID).attr("autocomplete","off").keyup(me.KeyChanged).keydown(function(e){switch(e.keyCode){case 38:me.selectionEnabled&&me.MoveSelectedUp();e.preventDefault();break;case 40:me.selectionEnabled&&me.MoveSelectedDown();e.preventDefault();break;case 27:$("#"+me.resultsID).hide()}}).bind("keypress keydown keyup",function(e){e.keyCode==13&&me.RedirectToResult(e)}).blur(function(){me.doNotHide||(me.hideTimeout&&clearTimeout(me.hideTimeout),me.hideTimeout=setTimeout(function(){me.HideResults()},300))});$("#"+me.resultsID).mousedown(function(){me.doNotHide=!0}).mouseup(function(){me.doNotHide&&(me.doNotHide=!1,$("#"+me.textBoxID).focus())}).mouseleave(function(){me.doNotHide&&(me.doNotHide=!1,$("#"+me.textBoxID).focus())})})}